<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- <script src="profile.js" type="module"></script> -->

    <style>
        .myPost {
            list-style: none;

            border: 1px solid;

            margin-bottom: 5px;
        }

        #body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            justify-items: center;
            gap: 10px;

            width: 70%;

            margin: 0 auto 0 auto;
        }

        #nav {
            border: 1px solid;

            width: 300px;
            height: 500px;
            max-height: 500px;

            text-align: center;

        }
    </style>

    <title>Document</title>
</head>
<body>
    <header>
        <h1>프로필</h1>
    </header>
    <div id="body">
        <nav id="nav">
            <p id="account">계정</p>
            <p id="posts">작성한 게시글</p>
        </nav>
        <section id="section"></section>
    </div>
</body>
<script>
    $(document).ready(function() {
        $.ajax({
            type: 'GET',
            url: '/api/userme',
            data: {},
            success: function(response) {
                getMyInfo(response['myInfo']);
                

                $('#nav').on('click', function(e)  {
                    if (e.target['id'] === 'account') {
                        getMyInfo(response['myInfo']);
                    } else if (e.target['id'] === 'posts') {
                        getMyPosts(response['myPosts']);
                    }
                })
            }
        })
    })

    function getMyInfo(myInfo) {
        $('#section').empty();
        let temp_html = `<div id="myInfo">
                            <input type="text" value="${myInfo['email']}" readonly>
                            <input type="text" value="${myInfo['nickname']}" readonly>
                            <p>${myInfo['intro']}</p>
                            <button>수정하기</button>
                        </div>`

        $('#section').append(temp_html);
    }

    function getMyPosts(myPosts) {
        $('#section').empty();
        const $myPosts = document.createElement('ul');
        myPosts.forEach(post => {
            let temp_html = `<li class="myPost">
                                <p>${post['title']}</p>
                                <p>${post['language']}</p>
                                <p>${post['createdAt']}</p>
                                <p>${post['updatedAt']}</p>
                            </li>`;

            // $('#myPosts').append(temp_html);
            $myPosts.innerHTML += temp_html;
        })
        // console.log($('#myPosts'));
        $('#section').append($myPosts);
    }
</script>
</html>